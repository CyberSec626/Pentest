
#Enumeration


# ENUMERAÇÃO


### HTTP 

Utilitários: nc | curl | telnet 

nc -v businesscorp.com.br 80 

   Host:192.168.0.159 
   HEAD / HTTP/1.0 
   GET /index.aspx HTTP/1.0 
   GET 
   OPTIONS 


### HTTPS 

   Openssl s_client -connect tesla.com:443 
   HEAD / HTTP/1.1 
   Host:www.tesla.com.br 

Openssl s_client -quiet -connect tesla.com:443 #O '-quiet' omite diversas informações e nos da uma saída mais limpa. 

   HEAD / HTTP/1.1 
   Host:www.tesla.com.br 


### IDENTIFICANDO WAF 

wafw00f [www.alvo.com.br](http://www.alvo.com.br) 


### FTP 

nc -v 172.16.108 21 
nc -v 172.16.108 21 
USER ricardo 
PASS senha 

ftp 172.16.1.108 
USER anonymous 
PASS anonymous 

ftp 172.16.1.108 
USER ftp 
PASS ftp 

### NETBIOS/SMB 

TERMINAL WINDOWS 

```cmd
whoami
ipconfig
ipconfig /all
dir
type
tasklist
net user
net group
```


TERMINAL LINUX

```bash
whoami
ifconfig
pwd
dir
ls
uname -a
hostname
sudo -l
cat
more
less
ls -la
```


nbtscan -r 172.16.1.0/24 

smbclient -L [\\172.30.0.103](file:///\\172.30.0.103) -W DHC17 -N  

smbclient -L [\\172.16.1.4](file:///\\172.16.1.4) -U SMB -N 

smbclient //172.16.1.4/_DOCS -N 

smbclient -L [\\172.16.1.5](file:///\\172.16.1.5) -N --option='client min protocol=NT1 

### NUMERANDO COM RPC 

rpcclient -U "" -N 172.16.1.5 
rpcclient -U "rafaela" 172.16.1.4 

mostra todos os comandos que posso executar 
? 

Enumerando usuários
enumdomusers #enumera usuarios 

Visualizando  informações do usuário root. Pode ser que um usuário possa ser um vetor de ataque.
queryuser root

netshareenum #mostra informações de compartilhamento 

informações sobre o dominio 
querydominfo

Enumera os compartilhamentos 
netshareenum

Mostra os detalhes de todos os compartilhamentos 
netshareenumall

rpcclient -U "rafaela" 172.16.1.4 

Informações sobre o domínio 
querydominfo

Traz informações sobre o usuário rafaela 
queryuser rafaela 

Enumera grupos de usuários 
enumdomgroups

Descobre quantos usuários que fazem parte do grupo 0x200. Neste caso são os Domain Admins. 
querygroup 0x200

Mostra quais usuários aparecem parte dese grupo 
querygroupmem 0x200

queryuser 0x1f4 

Enumera todos os usuários existentes no sistema. 
enumdomusers

### AUTOMATIZANDO COM enum4linux 

enum4linux -U 172.16.1.5 #realiza a enumeração de usuários 
enum4linux -S 172.16.1.5 #Enumera informações de compartilhamento 
enum4linux -a 172.16.1.5 #Scan completo 
enum4linux -a 172.16.1.5 -u administrator -p #passa somente usuario 

USANDO SCRIPTS DO nmap NSE 

ls usr/share/nmap/scritps/smb #Aqui posso até testar vulnerabilidades do smb. 
nmap -v --script=smb-os-discovery 172.16.1.140 #reconhece as portas e tenta nos trazer o nome do Sistema Operacional. 
nmap -v --script=smb-vuln-ms* 172.16.1.140 #utiliza todos os scripts de vulnerabilidade somente em sistemas microsoft "ms*"  

### POP3 - PORTA 110 

nmap --open --sS -p 110 -Pn 172.16.0.0/24 
nc -v 37.59.174.227 110 


TELNET

telnet 37.59.174.227.110 
USER admin 
PASS admin 
STAT#mostra status 
LIST 
RETR 1 

telnet 37.59.174.227.110 
USER admin 
PASS admin 
STAT 
LIST 
RETR 1 

Posso encontrar login e senha no pastebin e utilizar aqui. 
USER camila 
PASS ca123456 
STAT #mostra status 
"+OK 3 2769" # 3 mensagens 
LIST # lista as mensagens 
"1 925" 
"2 974" 
"3 870" 

. 

RETR 1 #visualiza a primeira mensagem 

### SMTP 

nmap --open -sS -p 25 -Pn 172.30.0.1/24 

nc -v 172.30.0.128 25 
HELO desec - Enumera o usuário desec 
VRFY - Verifica um usuário 
Mail from: pentest #usuario pentest 
rcpt to: root #envia para root 
DATA #permite colocar dados na mensagem 
Ola root #mensagem 

### ENUMERANDO DISPOSITIVOS DE REDE - telnet - PORT 23 

nmap --open -sS -p 23 -Pn 172.16.1.0/24 
telnet 172.16.1.247 
show interfaces 
configure 

### SSH - PORT 22 

nmap --open -p22,2222 -Pn 172.16.1.0/24 

nc -v 172.16.1.1 22 

nc -vv 172.16.1.1 22 

SSH COM CHAVE PÚBLICA. 

.....


### NFS - NETWORK FILE SYSTEM. 

nmap --open -sS -p 2049 -Pn 172.16.1.0/24 

rpcinfo -p 172.16.1.5 | grep nfs #retorna as versoes nfs que o alvo suporta 

showmount -e 172.16.1.31 

mkdir /tmp/nfs 

mount -t nfs -o nfsvers=2 172.16.1.5:/ /tmp/nfs 

umount nfs 

### SNMP - PORT 161 - UDP - REVER A AULA ABAIXO DESSA.... 

COMANDOS 

[https://www.alvestrand.no/objectid/1.3.6.1.2.1.html](https://www.alvestrand.no/objectid/1.3.6.1.2.1.html) 

[http://www.oid-info.com/](http://www.oid-info.com/) 

instala e extrai as mibs. 
apt install snmp-mibs-downloader 

nmap -sVU -p161 -Pn 172.16.1.4 172.16.1.247 

onesixtyone 

onesixtyone -c comu.txt 172.16.1.0/24 

snmpwalk -c public -v1 172.16.1.4 1.3.6.1.4.1.77.1.2.25 

snmpwalk -c -v1 172.16.1.4  

echo "" > /etc/snmp/snmp.conf 

nos traz detalhes da consulta que realizamos. 
Snmptranslate -Td SNMPv2-MIB :: sysUpTime

snmpwalk -c juniper -v1 172.16.1.247 1.3.6.1.2.1.1.3 

snmptranslate -TB icmp #pesquisa por uma determinada função 

snmpwalk -c public v1 172.16.1.4 IP-MIB :: icmpInechos 

### MySQL 


Verificando hosts com MySQL na rede
```bash
nmap --open -sS -p 3306 -Pn 172.16.1.0/24 
```



```bash
mysql -h host 172.16.1.5 -u mysql 
```



```bash
mysql -h 172.16.1.5 -u mysql -p 
```




Mostra todas as bases de dados 

```bash
show databases; 
```


seleciona a base de dados 
```bash
use owasp; 
```


mostra as informações da tabela "credit_cards"
```bash
select * from credit_cards; 
```


```bash

```


### Active Directory

Enumerando usuários do AD. **users.realm** é o domínio e **usernames.txt** é a wordlist de usuários que deve ser conseguido durante a enumeração.
```bash
nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm='test.local',userdb=usernames.txt 10.10.10.1
```
> https://wadcoms.github.io/wadcoms/Nmap-Krb5-Enum-Users/

